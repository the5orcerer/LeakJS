patterns:
  # JavaScript-specific sensitive patterns

  # Environment Variables
  - pattern:
      name: "Node.js Environment Variable"
      regex: "process\\.env\\.[A-Z_][A-Z0-9_]*"
      confidence: "Medium"
  - pattern:
      name: "Browser Environment Variable"
      regex: "window\\.[A-Z_][A-Z0-9_]*"
      confidence: "Low"

  # Configuration Objects
  - pattern:
      name: "Firebase Config Object"
      regex: "firebaseConfig\\s*=\\s*\\{[^}]*apiKey\\s*:\\s*['\"][^'\"]{20,}['\"]"
      confidence: "High"
  - pattern:
      name: "AWS SDK Config"
      regex: "AWS\\.config\\.[^=]*=\\s*['\"][^'\"]{10,}['\"]"
      confidence: "Medium"
  - pattern:
      name: "Stripe Publishable Key in Config"
      regex: "STRIPE_PUBLISHABLE_KEY\\s*[:=]\\s*['\"](pk_[a-zA-Z0-9]{24})['\"]"
      confidence: "High"
  - pattern:
      name: "Stripe Secret Key in Config"
      regex: "STRIPE_SECRET_KEY\\s*[:=]\\s*['\"](sk_[a-zA-Z0-9]{24})['\"]"
      confidence: "High"

  # Database Connection Strings
  - pattern:
      name: "MongoDB Connection in Code"
      regex: "mongodb://[a-zA-Z0-9_-]+:[a-zA-Z0-9_-]+@[a-zA-Z0-9.-]+"
      confidence: "High"
  - pattern:
      name: "PostgreSQL Connection in Code"
      regex: "postgres://[a-zA-Z0-9_-]+:[a-zA-Z0-9_-]+@[a-zA-Z0-9.-]+"
      confidence: "High"
  - pattern:
      name: "MySQL Connection in Code"
      regex: "mysql://[a-zA-Z0-9_-]+:[a-zA-Z0-9_-]+@[a-zA-Z0-9.-]+"
      confidence: "High"
  - pattern:
      name: "Redis Connection in Code"
      regex: "redis://[a-zA-Z0-9_-]*:[a-zA-Z0-9_-]+@[a-zA-Z0-9.-]+"
      confidence: "High"

  # API Keys in Variable Assignments
  - pattern:
      name: "API Key Variable Assignment"
      regex: "(?:const|let|var)\\s+(?:apiKey|api_key|API_KEY)\\s*=\\s*['\"]([a-zA-Z0-9_-]{20,})['\"]"
      confidence: "Medium"
  - pattern:
      name: "Token Variable Assignment"
      regex: "(?:const|let|var)\\s+(?:token|TOKEN)\\s*=\\s*['\"]([a-zA-Z0-9_\\-\\./+=]{20,})['\"]"
      confidence: "Medium"
  - pattern:
      name: "Secret Variable Assignment"
      regex: "(?:const|let|var)\\s+(?:secret|SECRET)\\s*=\\s*['\"]([a-zA-Z0-9_\\-\\./+=]{20,})['\"]"
      confidence: "Medium"

  # Authentication Data
  - pattern:
      name: "JWT Token in Code"
      regex: "eyJ[A-Za-z0-9-_=]+\\.eyJ[A-Za-z0-9-_=]+\\.?[A-Za-z0-9-_.+/=]*"
      confidence: "Medium"
  - pattern:
      name: "Basic Auth Header"
      regex: "Basic [A-Za-z0-9+/=]{20,}"
      confidence: "Medium"
  - pattern:
      name: "Bearer Token"
      regex: "Bearer [A-Za-z0-9_\\-\\./+=]{20,}"
      confidence: "Medium"

  # OAuth and Social Login
  - pattern:
      name: "Google OAuth Client ID"
      regex: "[0-9]+-[0-9A-Za-z_]{32}\\.apps\\.googleusercontent\\.com"
      confidence: "High"
  - pattern:
      name: "Facebook App ID"
      regex: "\\b\\d{15}\\b"
      confidence: "Medium"
  - pattern:
      name: "Twitter Consumer Key"
      regex: "[A-Za-z0-9]{25}"
      confidence: "Medium"
  - pattern:
      name: "GitHub Client ID"
      regex: "[a-f0-9]{20}"
      confidence: "Medium"

  # Cloud Service Credentials
  - pattern:
      name: "AWS Access Key in Code"
      regex: "AKIA[0-9A-Z]{16}"
      confidence: "High"
  - pattern:
      name: "AWS Secret Key in Code"
      regex: "[0-9a-zA-Z/+]{40}"
      confidence: "Medium"
  - pattern:
      name: "Google Service Account Key"
      regex: '"type":\\s*"service_account"'
      confidence: "Medium"
  - pattern:
      name: "Azure Storage Key"
      regex: "[0-9a-zA-Z/+]{88}={0,2}"
      confidence: "High"

  # Payment Processing
  - pattern:
      name: "Stripe Test Key"
      regex: "sk_test_[0-9a-zA-Z]{24}"
      confidence: "Medium"
  - pattern:
      name: "Stripe Live Key"
      regex: "sk_live_[0-9a-zA-Z]{24}"
      confidence: "High"
  - pattern:
      name: "PayPal Client ID"
      regex: "A[0-9a-zA-Z-_]{71}"
      confidence: "High"
  - pattern:
      name: "Braintree Access Token"
      regex: "access_token\\$production\\$[0-9a-zA-Z]{16}\\$[0-9a-f]{32}"
      confidence: "High"

  # Communication Services
  - pattern:
      name: "Twilio Account SID"
      regex: "AC[0-9a-f]{32}"
      confidence: "High"
  - pattern:
      name: "Twilio Auth Token"
      regex: "[0-9a-f]{32}"
      confidence: "High"
  - pattern:
      name: "SendGrid API Key"
      regex: "SG\\.[0-9A-Za-z_-]{22}\\.[0-9A-Za-z_-]{43}"
      confidence: "High"
  - pattern:
      name: "Slack Token"
      regex: "xox[baprs]-[0-9a-zA-Z-]{10,48}"
      confidence: "High"

  # Private Keys and Certificates
  - pattern:
      name: "RSA Private Key"
      regex: "-----BEGIN RSA PRIVATE KEY-----"
      confidence: "High"
  - pattern:
      name: "EC Private Key"
      regex: "-----BEGIN EC PRIVATE KEY-----"
      confidence: "High"
  - pattern:
      name: "OpenSSH Private Key"
      regex: "-----BEGIN OPENSSH PRIVATE KEY-----"
      confidence: "High"
  - pattern:
      name: "X.509 Certificate"
      regex: "-----BEGIN CERTIFICATE-----"
      confidence: "Medium"

  # Internal/Development URLs
  - pattern:
      name: "Internal API Endpoint"
      regex: "https?://(?:localhost|127\\.0\\.0\\.1|0\\.0\\.0\\.0|\\[::1\\]):[0-9]+"
      confidence: "Low"
  - pattern:
      name: "Development Database URL"
      regex: "(?:mongodb|postgres|mysql)://.*localhost"
      confidence: "Low"
  - pattern:
      name: "Staging Environment URL"
      regex: "https?://.*staging\\.[a-zA-Z0-9.-]+"
      confidence: "Low"

  # Hardcoded Credentials
  - pattern:
      name: "Hardcoded Password"
      regex: "(?:password|PASSWORD|Password)\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"
  - pattern:
      name: "Hardcoded Username"
      regex: "(?:username|USERNAME|Username)\\s*[:=]\\s*['\"]([^'\"]{3,})['\"]"
      confidence: "Medium"
  - pattern:
      name: "Hardcoded Email"
      regex: "(?:email|EMAIL|Email)\\s*[:=]\\s*['\"]([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})['\"]"
      confidence: "Medium"

  # Configuration Files Content
  - pattern:
      name: "JSON Config with Secrets"
      regex: '"(?:apiKey|secret|token|password)"\\s*:\\s*"[^"]{20,}"'
      confidence: "Medium"
  - pattern:
      name: "YAML Config with Secrets"
      regex: "(?:apiKey|secret|token|password):\\s*['\"]?[^'\"\\n]{20,}['\"]?"
      confidence: "Medium"

  # Browser-specific Patterns
  - pattern:
      name: "LocalStorage with Sensitive Data"
      regex: "localStorage\\.(?:setItem|getItem)\\(['\"](?:token|apiKey|secret)"
      confidence: "Medium"
  - pattern:
      name: "SessionStorage with Sensitive Data"
      regex: "sessionStorage\\.(?:setItem|getItem)\\(['\"](?:token|apiKey|secret)"
      confidence: "Medium"
  - pattern:
      name: "Cookie with Sensitive Data"
      regex: "document\\.cookie.*(?:token|apiKey|secret)"
      confidence: "Medium"

  # Third-party Service Configurations
  - pattern:
      name: "Sentry DSN"
      regex: "https://[0-9a-f]{32}@[a-zA-Z0-9.-]+/[0-9]+"
      confidence: "High"
  - pattern:
      name: "LogRocket App ID"
      regex: "[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}"
      confidence: "Medium"
  - pattern:
      name: "Mixpanel Token"
      regex: "[a-f0-9]{32}"
      confidence: "Medium"
  - pattern:
      name: "Segment Write Key"
      regex: "[A-Za-z0-9]{22}"
      confidence: "Medium"

  # Personal Information
  - pattern:
      name: "Email Address in Code"
      regex: "\\b[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\\b"
      confidence: "Low"
  - pattern:
      name: "Phone Number in Code"
      regex: "\\+?[1-9]\\d{1,14}"
      confidence: "Low"
  - pattern:
      name: "Credit Card Number"
      regex: "\\b\\d{4}[- ]?\\d{4}[- ]?\\d{4}[- ]?\\d{4}\\b"
      confidence: "High"
  - pattern:
      name: "Social Security Number"
      regex: "\\b\\d{3}-\\d{2}-\\d{4}\\b"
      confidence: "High"

  # Debug and Development Data
  - pattern:
      name: "Console Log with Sensitive Data"
      regex: "console\\.(?:log|warn|error|info)\\([^)]*(?:password|token|secret|key|credential)"
      confidence: "Low"
  - pattern:
      name: "Test Data with Real Credentials"
      regex: "(?:test|example|sample|demo).*['\"](sk_live|pk_live|AKIA|eyJ)"
      confidence: "Medium"
  - pattern:
      name: "Commented Sensitive Data"
      regex: "//.*(?:password|token|secret|key).*['\"]([^'\"]{8,})['\"]"
      confidence: "Medium"

  # Webhook and Callback URLs
  - pattern:
      name: "Slack Webhook URL"
      regex: "https://hooks\\.slack\\.com/services/T[0-9A-Z]{8}/B[0-9A-Z]{8}/[0-9a-zA-Z]{24}"
      confidence: "High"
  - pattern:
      name: "Discord Webhook URL"
      regex: "https://discord(?:app)?\\.com/api/webhooks/[0-9]{18,19}/[a-zA-Z0-9_-]{68}"
      confidence: "High"
  - pattern:
      name: "GitHub Webhook Secret"
      regex: "[a-f0-9]{40}"
      confidence: "Medium"

  # Encryption Keys
  - pattern:
      name: "AES Encryption Key"
      regex: "[Aa]es[_-]?[Kk]ey\\s*[:=]\\s*['\"]([a-fA-F0-9]{32}|[a-fA-F0-9]{64})['\"]"
      confidence: "Medium"
  - pattern:
      name: "HMAC Secret Key"
      regex: "[Hh]mac[_-]?[Ss]ecret\\s*[:=]\\s*['\"]([a-zA-Z0-9_\\-\\./+=]{20,})['\"]"
      confidence: "Medium"
  - pattern:
      name: "JWT Secret Key"
      regex: "[Jj]wt[_-]?[Ss]ecret\\s*[:=]\\s*['\"]([a-zA-Z0-9_\\-\\./+=]{20,})['\"]"
      confidence: "Medium"

  # Database Configuration
  - pattern:
      name: "Database Password in Config"
      regex: "(?:db|database)[_-]?password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"
  - pattern:
      name: "Database Username in Config"
      regex: "(?:db|database)[_-]?user(?:name)?\\s*[:=]\\s*['\"]([^'\"]{3,})['\"]"
      confidence: "Medium"
  - pattern:
      name: "Redis Password in Config"
      regex: "redis[_-]?password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"
  - pattern:
      name: "MongoDB URI with Credentials"
      regex: "mongodb(?:\\+srv)?://[a-zA-Z0-9_-]+:[a-zA-Z0-9_-]+@[a-zA-Z0-9.-]+"
      confidence: "High"