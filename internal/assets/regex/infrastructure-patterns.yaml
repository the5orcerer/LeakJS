patterns:
  # Infrastructure and DevOps Patterns

  # Docker and Container Patterns

  # Docker Environment Variables
  - pattern:
      name: "Docker ENV with Secrets"
      regex: "ENV\\s+[A-Z_][A-Z0-9_]*\\s*=\\s*['\"]?([^'\"\\s]{20,})['\"]?"
      confidence: "Medium"
  - pattern:
      name: "Docker ARG with Secrets"
      regex: "ARG\\s+[A-Z_][A-Z0-9_]*\\s*=\\s*['\"]?([^'\"\\s]{20,})['\"]?"
      confidence: "Medium"

  # Docker Secrets
  - pattern:
      name: "Docker Secret File"
      regex: "/run/secrets/[a-zA-Z0-9_-]+"
      confidence: "Medium"
  - pattern:
      name: "Docker Compose Secrets"
      regex: "secrets:\\s*\\n\\s*-\\s*[a-zA-Z0-9_-]+"
      confidence: "Medium"

  # Kubernetes Patterns

  # Kubernetes Secrets
  - pattern:
      name: "K8s Secret YAML"
      regex: "kind:\\s*Secret"
      confidence: "Medium"
  - pattern:
      name: "K8s ConfigMap with Secrets"
      regex: "kind:\\s*ConfigMap\\s*\\n.*data:"
      confidence: "Low"
  - pattern:
      name: "K8s Service Account Token"
      regex: "serviceAccountToken"
      confidence: "Medium"

  # Kubernetes Environment Variables
  - pattern:
      name: "K8s ENV Secret"
      regex: "env:\\s*\\n\\s*-\\s*name:\\s*[A-Z_][A-Z0-9_]*\\s*\\n\\s*valueFrom:\\s*\\n\\s*secretKeyRef:"
      confidence: "Medium"
  - pattern:
      name: "K8s Volume Secret"
      regex: "volumes:\\s*\\n\\s*-\\s*name:\\s*[a-zA-Z0-9_-]+\\s*\\n\\s*secret:"
      confidence: "Medium"

  # AWS Infrastructure Patterns

  # AWS Access Keys
  - pattern:
      name: "AWS Access Key ID"
      regex: "AKIA[0-9A-Z]{16}"
      confidence: "High"
  - pattern:
      name: "AWS Secret Access Key"
      regex: "[0-9a-zA-Z/+]{40}"
      confidence: "High"
  - pattern:
      name: "AWS Session Token"
      regex: "[0-9a-zA-Z/+]{300,}"
      confidence: "High"

  # AWS Infrastructure
  - pattern:
      name: "AWS Account ID"
      regex: "\\b\\d{12}\\b"
      confidence: "Medium"
  - pattern:
      name: "AWS Region"
      regex: "(?:us|eu|ap|sa|ca|me|af)-(?:east|west|south|north|central)-\\d+"
      confidence: "Low"
  - pattern:
      name: "AWS S3 Bucket URL"
      regex: "https://[a-z0-9.-]+\\.s3(?:\\.[a-z0-9-]+)?\\.amazonaws\\.com"
      confidence: "Low"

  # AWS Lambda Environment
  - pattern:
      name: "Lambda Environment Variables"
      regex: "Environment:\\s*\\n\\s*Variables:"
      confidence: "Low"
  - pattern:
      name: "Lambda Function URL"
      regex: "https://[a-z0-9]+\\.lambda-url\\.[a-z0-9-]+\\.on\\.aws/"
      confidence: "Low"

  # CloudFormation Templates
  - pattern:
      name: "CloudFormation Parameter with Secret"
      regex: "Parameters:\\s*\\n\\s*[A-Z][a-zA-Z0-9]*:\\s*\\n\\s*Type:\\s*String\\s*\\n\\s*Default:\\s*['\"]([^'\"]{20,})['\"]"
      confidence: "Medium"

  # Terraform Patterns

  # Terraform Variables
  - pattern:
      name: "Terraform Variable with Secret"
      regex: "variable\\s+['\"][a-z_][a-z0-9_]*['\"]\\s*\\{\\s*\\n\\s*default\\s*=\\s*['\"]([^'\"]{20,})['\"]"
      confidence: "Medium"
  - pattern:
      name: "Terraform Local with Secret"
      regex: "locals\\s*\\{\\s*\\n\\s*[a-z_][a-z0-9_]*\\s*=\\s*['\"]([^'\"]{20,})['\"]"
      confidence: "Medium"

  # Terraform AWS Provider
  - pattern:
      name: "Terraform AWS Access Key"
      regex: "access_key\\s*=\\s*['\"](AKIA[0-9A-Z]{16})['\"]"
      confidence: "High"
  - pattern:
      name: "Terraform AWS Secret Key"
      regex: "secret_key\\s*=\\s*['\"]([0-9a-zA-Z/+]{40})['\"]"
      confidence: "High"

  # CI/CD Patterns

  # GitHub Actions
  - pattern:
      name: "GitHub Actions Secret"
      regex: "secrets\\.[A-Z_][A-Z0-9_]*"
      confidence: "Medium"
  - pattern:
      name: "GitHub Token"
      regex: "github_token\\s*[:=]\\s*['\"](ghp_[a-zA-Z0-9]{36})['\"]"
      confidence: "High"
  - pattern:
      name: "GitHub App Private Key"
      regex: "-----BEGIN RSA PRIVATE KEY-----"
      confidence: "High"

  # GitLab CI
  - pattern:
      name: "GitLab CI Variable"
      regex: "\\$[A-Z_][A-Z0-9_]*"
      confidence: "Medium"
  - pattern:
      name: "GitLab Runner Token"
      regex: "glrt-[a-zA-Z0-9_-]{20,}"
      confidence: "High"

  # Jenkins
  - pattern:
      name: "Jenkins API Token"
      regex: "[a-f0-9]{32,}"
      confidence: "Medium"
  - pattern:
      name: "Jenkins Crumb"
      regex: "Jenkins-Crumb\\s*[:=]\\s*['\"]([a-f0-9]{32})['\"]"
      confidence: "Medium"

  # CircleCI
  - pattern:
      name: "CircleCI Token"
      regex: "[a-f0-9]{40}"
      confidence: "High"
  - pattern:
      name: "CircleCI Context"
      regex: "context\\s*[:=]\\s*['\"]([a-zA-Z0-9_-]+)['\"]"
      confidence: "Low"

  # Travis CI
  - pattern:
      name: "Travis CI Token"
      regex: "[a-f0-9]{40}"
      confidence: "High"
  - pattern:
      name: "Travis CI Repo Slug"
      regex: "[a-zA-Z0-9_-]+/[a-zA-Z0-9_-]+"
      confidence: "Low"

  # Infrastructure as Code

  # Ansible Vault
  - pattern:
      name: "Ansible Vault Password"
      regex: "ansible-vault-password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"
  - pattern:
      name: "Ansible Become Password"
      regex: "ansible_become_password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"

  # Puppet
  - pattern:
      name: "Puppet Hiera Key"
      regex: "hiera\\(['\"]([^'\"]*secret|[^'\"]*password)"
      confidence: "Medium"

  # Chef
  - pattern:
      name: "Chef Data Bag Secret"
      regex: "data_bag_item\\(['\"]([^'\"]*secret|[^'\"]*password)"
      confidence: "Medium"
  - pattern:
      name: "Chef Encrypted Data Bag"
      regex: "encrypted_data_bag_item"
      confidence: "Medium"

  # Monitoring and Logging

  # ELK Stack
  - pattern:
      name: "Elasticsearch API Key"
      regex: "[a-zA-Z0-9_-]{22}"
      confidence: "Medium"
  - pattern:
      name: "Logstash Pipeline Password"
      regex: "password\\s*=>\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "Medium"

  # Prometheus
  - pattern:
      name: "Prometheus Basic Auth"
      regex: "basic_auth:\\s*\\n\\s*username:\\s*['\"]([^'\"]+)['\"]\\s*\\n\\s*password:\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"

  # Grafana
  - pattern:
      name: "Grafana API Key"
      regex: "eyJr[a-zA-Z0-9_-]+"
      confidence: "High"
  - pattern:
      name: "Grafana Admin Password"
      regex: "admin_password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"

  # Database Infrastructure

  # Database Connection Strings
  - pattern:
      name: "MongoDB Connection String"
      regex: "mongodb(?:\\+srv)?://[^:]+:[^@]+@"
      confidence: "High"
  - pattern:
      name: "PostgreSQL Connection String"
      regex: "postgresql://[^:]+:[^@]+@"
      confidence: "High"
  - pattern:
      name: "MySQL Connection String"
      regex: "mysql://[^:]+:[^@]+@"
      confidence: "High"
  - pattern:
      name: "Redis Connection String"
      regex: "redis://[^:]+:[^@]+@"
      confidence: "High"

  # Database Admin Credentials
  - pattern:
      name: "Database Root Password"
      regex: "root_password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"
  - pattern:
      name: "Database Admin Password"
      regex: "admin_password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"

  # Cloud Database
  - pattern:
      name: "RDS Endpoint"
      regex: "[a-z0-9-]+\\.rds\\.amazonaws\\.com"
      confidence: "Low"
  - pattern:
      name: "Cloud SQL Instance"
      regex: "[a-z0-9-]+:[a-z0-9-]+:[a-z0-9-]+"
      confidence: "Low"

  # Network Infrastructure

  # VPN and SSH
  - pattern:
      name: "SSH Private Key"
      regex: "-----BEGIN (?:OPENSSH|RSA|DSA|EC) PRIVATE KEY-----"
      confidence: "High"
  - pattern:
      name: "SSH Public Key"
      regex: "ssh-(?:rsa|dss|ed25519) [A-Za-z0-9+/]+[=]{0,3}"
      confidence: "Medium"
  - pattern:
      name: "VPN Pre-shared Key"
      regex: "psk\\s*[:=]\\s*['\"]([a-zA-Z0-9+/]{20,})['\"]"
      confidence: "High"

  # Load Balancer
  - pattern:
      name: "HAProxy Password"
      regex: "password\\s+[a-zA-Z0-9_-]{8,}"
      confidence: "Medium"
  - pattern:
      name: "Nginx Basic Auth"
      regex: "auth_basic_user_file\\s+['\"]([^'\"]*password|[^'\"]*secret)"
      confidence: "Medium"

  # Certificate Management

  # SSL/TLS Certificates
  - pattern:
      name: "SSL Certificate Private Key"
      regex: "-----BEGIN PRIVATE KEY-----"
      confidence: "High"
  - pattern:
      name: "SSL Certificate Chain"
      regex: "-----BEGIN CERTIFICATE-----"
      confidence: "Medium"
  - pattern:
      name: "Certificate Authority Key"
      regex: "-----BEGIN CERTIFICATE AUTHORITY KEY-----"
      confidence: "High"

  # Let's Encrypt
  - pattern:
      name: "Let's Encrypt Account Key"
      regex: "-----BEGIN EC PRIVATE KEY-----"
      confidence: "High"

  # Service Mesh

  # Istio
  - pattern:
      name: "Istio Certificate"
      regex: "istio\\.default"
      confidence: "Low"
  - pattern:
      name: "Istio Secret"
      regex: "istio\\.security"
      confidence: "Low"

  # Linkerd
  - pattern:
      name: "Linkerd Identity Secret"
      regex: "linkerd-identity-issuer"
      confidence: "Medium"

  # API Gateway

  # Kong
  - pattern:
      name: "Kong Admin API Key"
      regex: "kong-admin-token\\s*[:=]\\s*['\"]([a-zA-Z0-9_-]{32})['\"]"
      confidence: "High"

  # API Gateway Keys
  - pattern:
      name: "API Gateway Key"
      regex: "[a-zA-Z0-9_-]{20,}"
      confidence: "Medium"
  - pattern:
      name: "API Gateway Secret"
      regex: "[a-zA-Z0-9_-]{40,}"
      confidence: "High"

  # Infrastructure Monitoring

  # Nagios
  - pattern:
      name: "Nagios Password"
      regex: "nagios_password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"

  # Zabbix
  - pattern:
      name: "Zabbix API Token"
      regex: "[a-f0-9]{32}"
      confidence: "Medium"

  # Infrastructure Automation

  # Packer
  - pattern:
      name: "Packer AWS Access Key"
      regex: "access_key\\s*=\\s*['\"](AKIA[0-9A-Z]{16})['\"]"
      confidence: "High"
  - pattern:
      name: "Packer AWS Secret Key"
      regex: "secret_key\\s*=\\s*['\"]([0-9a-zA-Z/+]{40})['\"]"
      confidence: "High"

  # Vagrant
  - pattern:
      name: "Vagrant Box URL"
      regex: "config\\.vm\\.box_url\\s*=\\s*['\"]([^'\"]+)['\"]"
      confidence: "Low"
  - pattern:
      name: "Vagrant Private Key"
      regex: "config\\.ssh\\.private_key_path\\s*=\\s*['\"]([^'\"]*key|[^'\"]*pem)['\"]"
      confidence: "Medium"

  # Backup and Recovery

  # Backup Credentials
  - pattern:
      name: "Backup Encryption Key"
      regex: "backup_key\\s*[:=]\\s*['\"]([a-zA-Z0-9+/]{20,})['\"]"
      confidence: "High"
  - pattern:
      name: "Backup Password"
      regex: "backup_password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"

  # Disaster Recovery
  - pattern:
      name: "DR Site Credentials"
      regex: "dr_password\\s*[:=]\\s*['\"]([^'\"]{8,})['\"]"
      confidence: "High"
  - pattern:
      name: "Failover Token"
      regex: "failover_token\\s*[:=]\\s*['\"]([a-zA-Z0-9_-]{32})['\"]"
      confidence: "High"